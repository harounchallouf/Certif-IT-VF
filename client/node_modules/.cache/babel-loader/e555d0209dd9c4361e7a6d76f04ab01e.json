{"ast":null,"code":"import _objectSpread from\"C:/Users/Lenovo/Desktop/project-3-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/objectSpread2\";import _classCallCheck from\"C:/Users/Lenovo/Desktop/project-3-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"C:/Users/Lenovo/Desktop/project-3-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"C:/Users/Lenovo/Desktop/project-3-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"C:/Users/Lenovo/Desktop/project-3-master/client/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Container,Image,Col,Row,Button}from'react-bootstrap';import{Link}from'react-router-dom';import React,{Component}from'react';import{motion}from'framer-motion';import UsersServices from'./../../../../service/users.service';import CoursesServices from'./../../../../service/courses.service';import TeacherServices from'./../../../../service/teachers.service';import CourseCard from'./../../../shared/CourseCard/Course-card';import TeacherCard from'./../../TeachersList/TeacherCard';import Popup from'../../../shared/Popup/Popup';import DeleteMessage from'../../../shared/Delete-message/DeleteMessage';import TabNav from'./../../../shared/TabsNav/TabNav';import Tab from'./../../../shared/TabsNav/Tab';import'./UserProfile.css';var UserProfile=/*#__PURE__*/function(_Component){_inherits(UserProfile,_Component);var _super=_createSuper(UserProfile);function UserProfile(){var _this;_classCallCheck(this,UserProfile);_this=_super.call(this);_this.componentDidMount=function(){_this.refreshCourses();_this.getFavsCourses();_this.getFavsTeachers();};_this.setSelected=function(tab){return _this.setState({selected:tab});};_this.refreshCourses=function(){_this.coursesServices.getRandomCourses().then(function(response){return _this.setState({randomCourses:response.data});}).catch(function(){_this.props.history.push('/');_this.props.handleToast(true,'An error has occurred, please try again later','#f8d7da');});if(_this.props.teacherInfo){_this.coursesServices.getTeacherCourses(_this.props.teacherInfo._id).then(function(response){return _this.setState({teacherCourses:response.data});}).catch(function(){_this.props.history.push('/');_this.props.handleToast(true,'An error has occurred, please try again later','#f8d7da');});}};_this.getFavsCourses=function(){if(_this.props.loggedUser.favCourses){_this.usersServices.getUserFavCourses(_this.props.loggedUser._id).then(function(response){return _this.setState({favCourses:response.data});}).catch(function(){_this.props.history.push('/');_this.props.handleToast(true,'An error has occurred, please try again later','#f8d7da');});}};_this.getFavsTeachers=function(){if(_this.props.loggedUser.favTeachers){_this.usersServices.getUserFavTeachers(_this.props.loggedUser._id).then(function(response){return _this.setState({favTeachers:response.data});}).catch(function(){_this.props.history.push('/');_this.props.handleToast(true,'An error has occurred, please try again later','#f8d7da');});}};_this.componentDidUpdate=function(currentProps){_this.state.favCourses.length!==currentProps.loggedUser.favCourses.length&&_this.getFavsCourses();_this.state.favTeachers.length!==currentProps.loggedUser.favTeachers.length&&_this.getFavsTeachers();};_this.deleteUser=function(){_this.usersServices.deleteUser(_this.props.loggedUser._id).then(function(){_this.props.handleToast(true,'User deleted','#d4edda');_this.props.storeUser(undefined);_this.props.history.push('/');}).catch(function(){_this.props.history.push('/');_this.props.handleToast(true,'An error has occurred while deleting, please try again later','#f8d7da');});};_this.handleModal=function(visible){return _this.setState({showModal:visible});};_this.state={teacherCourses:undefined,favCourses:[],favTeachers:[],learningActivity:[],showModal:false,selected:'Favorite Courses',randomCourses:[]};_this.usersServices=new UsersServices();_this.coursesServices=new CoursesServices();_this.teachersServices=new TeacherServices();return _this;}_createClass(UserProfile,[{key:\"render\",value:function render(){var _this2=this;return/*#__PURE__*/_jsxs(motion.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},children:[/*#__PURE__*/_jsxs(Popup,{show:this.state.showModal,handleModal:this.handleModal,color:'#f8d7da',children:[/*#__PURE__*/_jsx(DeleteMessage,{}),/*#__PURE__*/_jsxs(Row,{className:\"justify-content-center\",children:[/*#__PURE__*/_jsx(Col,{xs:\"auto\",children:/*#__PURE__*/_jsx(Button,{variant:\"secondary\",onClick:function onClick(){return _this2.handleModal(false);},children:\"Close\"})}),/*#__PURE__*/_jsx(Col,{xs:\"auto\",children:/*#__PURE__*/_jsx(Button,{to:\"/profile/delete-user/\".concat(this.props.loggedUser._id),onClick:this.deleteUser,variant:\"danger\",children:\"Delete account\"})})]})]}),/*#__PURE__*/_jsxs(Container,{className:\"user-profile\",children:[/*#__PURE__*/_jsxs(\"h1\",{className:\"mt-5 mb-3\",children:[\"Welcome back \",this.props.loggedUser.username,\" !\"]}),/*#__PURE__*/_jsxs(\"section\",{className:\"user-details\",children:[/*#__PURE__*/_jsxs(\"article\",{children:[/*#__PURE__*/_jsx(Image,{src:this.props.loggedUser.imageUrl,className:\"user-img\",roundedCircle:true,alt:this.props.loggedUser.username}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-fields\",children:[/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Username:\"}),\" \",this.props.loggedUser.username]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Email:\"}),\" \",this.props.loggedUser.email]}),/*#__PURE__*/_jsxs(\"p\",{children:[/*#__PURE__*/_jsx(\"strong\",{children:\"Role:\"}),\" \",this.props.loggedUser.role]})]})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"user-buttons\",children:[/*#__PURE__*/_jsx(Link,{to:\"/profile/edit-user\",className:\"btn btn-info\",children:\"Edit details\"}),/*#__PURE__*/_jsx(Button,{onClick:function onClick(){return _this2.handleModal(true);},className:\"btn btn-danger\",children:\"Delete user\"}),this.props.loggedUser.role==='Teacher'&&this.props.teacherInfo?/*#__PURE__*/_jsx(Link,{to:\"/teachers/\".concat(this.props.teacherInfo._id),className:\"btn btn-warning\",children:\"Teacher profile\"}):this.props.loggedUser.role==='Teacher'&&!this.props.teacherInfo?/*#__PURE__*/_jsx(Link,{to:\"/profile/create-teacher\",className:\"btn btn-success\",children:\"Create teacher profile\"}):null]})]}),/*#__PURE__*/_jsx(\"h2\",{className:\"mt-5 mb-3\",children:\"Your activity\"}),/*#__PURE__*/_jsx(Row,{className:\"mt-5\",children:/*#__PURE__*/_jsx(Col,{children:/*#__PURE__*/_jsxs(TabNav,{tabs:['Favorite Courses','Favorite Teachers','Suggested Courses'],selected:this.state.selected,setSelected:this.setSelected,children:[this.state.favCourses.length>0&&/*#__PURE__*/_jsx(Tab,{isSelected:this.state.selected==='Favorite Courses',children:/*#__PURE__*/_jsx(\"section\",{children:/*#__PURE__*/_jsx(Row,{children:this.state.favCourses.map(function(elm){return/*#__PURE__*/_jsx(CourseCard,_objectSpread(_objectSpread({},elm),{},{userInfo:_this2.props.loggedUser,teacher:_this2.props.teacherInfo,updateFavCourses:_this2.props.updateFavCourses}),elm._id);})})})}),this.state.favTeachers.length>0&&/*#__PURE__*/_jsx(Tab,{isSelected:this.state.selected==='Favorite Teachers',children:/*#__PURE__*/_jsx(Row,{style:{width:'100 %'},children:this.state.favTeachers.map(function(elm){return/*#__PURE__*/_jsx(TeacherCard,_objectSpread(_objectSpread({},elm),{},{userInfo:_this2.props.loggedUser,teacher:_this2.props.teacherInfo,updateFavTeachers:_this2.props.updateFavTeachers}),elm._id);})})}),this.state.randomCourses.length>0&&/*#__PURE__*/_jsx(Tab,{isSelected:this.state.selected==='Suggested Courses',children:/*#__PURE__*/_jsx(Row,{children:this.state.randomCourses.map(function(elm){return/*#__PURE__*/_jsx(CourseCard,_objectSpread(_objectSpread({},elm),{},{userInfo:_this2.props.loggedUser,teacher:_this2.props.teacherInfo,updateFavCourses:_this2.props.updateFavCourses}),elm._id);})})})]})})}),/*#__PURE__*/_jsx(Link,{to:\"/courses\",className:\"btn btn-outline-dark mt-5\",children:\"Go back\"})]})]});}}]);return UserProfile;}(Component);export default UserProfile;","map":{"version":3,"sources":["C:/Users/Lenovo/Desktop/project-3-master/client/src/components/pages/Profiles/UserProfile/UserProfile.js"],"names":["Container","Image","Col","Row","Button","Link","React","Component","motion","UsersServices","CoursesServices","TeacherServices","CourseCard","TeacherCard","Popup","DeleteMessage","TabNav","Tab","UserProfile","componentDidMount","refreshCourses","getFavsCourses","getFavsTeachers","setSelected","tab","setState","selected","coursesServices","getRandomCourses","then","response","randomCourses","data","catch","props","history","push","handleToast","teacherInfo","getTeacherCourses","_id","teacherCourses","loggedUser","favCourses","usersServices","getUserFavCourses","favTeachers","getUserFavTeachers","componentDidUpdate","currentProps","state","length","deleteUser","storeUser","undefined","handleModal","visible","showModal","learningActivity","teachersServices","opacity","username","imageUrl","email","role","map","elm","updateFavCourses","width","updateFavTeachers"],"mappings":"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","sourcesContent":["import { Container, Image, Col, Row, Button } from 'react-bootstrap'\nimport { Link } from 'react-router-dom'\nimport React, { Component } from 'react'\nimport { motion } from 'framer-motion'\nimport UsersServices from './../../../../service/users.service'\nimport CoursesServices from './../../../../service/courses.service'\nimport TeacherServices from './../../../../service/teachers.service'\n\nimport CourseCard from './../../../shared/CourseCard/Course-card'\nimport TeacherCard from './../../TeachersList/TeacherCard'\nimport Popup from '../../../shared/Popup/Popup'\nimport DeleteMessage from '../../../shared/Delete-message/DeleteMessage'\nimport TabNav from './../../../shared/TabsNav/TabNav'\nimport Tab from './../../../shared/TabsNav/Tab'\n\nimport './UserProfile.css'\n\nclass UserProfile extends Component {\n  constructor() {\n    super()\n    this.state = {\n      teacherCourses: undefined,\n      favCourses: [],\n      favTeachers: [],\n      learningActivity: [],\n      showModal: false,\n      selected: 'Favorite Courses',\n      randomCourses: []\n    }\n    this.usersServices = new UsersServices()\n    this.coursesServices = new CoursesServices()\n    this.teachersServices = new TeacherServices()\n  }\n\n  componentDidMount = () => {\n    this.refreshCourses()\n    this.getFavsCourses()\n    this.getFavsTeachers()\n  }\n\n  setSelected = tab => this.setState({ selected: tab })\n\n  refreshCourses = () => {\n    this.coursesServices\n      .getRandomCourses()\n      .then(response => this.setState({ randomCourses: response.data }))\n      .catch(() => {\n        this.props.history.push('/')\n        this.props.handleToast(true, 'An error has occurred, please try again later', '#f8d7da')\n      })\n\n    if (this.props.teacherInfo) {\n      this.coursesServices\n        .getTeacherCourses(this.props.teacherInfo._id)\n        .then(response => this.setState({ teacherCourses: response.data }))\n        .catch(() => {\n          this.props.history.push('/')\n          this.props.handleToast(true, 'An error has occurred, please try again later', '#f8d7da')\n        })\n    }\n  }\n\n  getFavsCourses = () => {\n    if (this.props.loggedUser.favCourses) {\n      this.usersServices\n        .getUserFavCourses(this.props.loggedUser._id)\n        .then(response => this.setState({ favCourses: response.data }))\n        .catch(() => {\n          this.props.history.push('/')\n          this.props.handleToast(true, 'An error has occurred, please try again later', '#f8d7da')\n        })\n    }\n  }\n\n  getFavsTeachers = () => {\n    if (this.props.loggedUser.favTeachers) {\n      this.usersServices\n        .getUserFavTeachers(this.props.loggedUser._id)\n        .then(response => this.setState({ favTeachers: response.data }))\n        .catch(() => {\n          this.props.history.push('/')\n          this.props.handleToast(true, 'An error has occurred, please try again later', '#f8d7da')\n        })\n    }\n  }\n\n  componentDidUpdate = currentProps => {\n    this.state.favCourses.length !== currentProps.loggedUser.favCourses.length && this.getFavsCourses()\n    this.state.favTeachers.length !== currentProps.loggedUser.favTeachers.length && this.getFavsTeachers()\n  }\n\n\n  deleteUser = () => {\n    this.usersServices\n      .deleteUser(this.props.loggedUser._id)\n      .then(() => {\n        this.props.handleToast(true, 'User deleted', '#d4edda')\n        this.props.storeUser(undefined)\n        this.props.history.push('/')\n      })\n      .catch(() => {\n        this.props.history.push('/')\n        this.props.handleToast(true, 'An error has occurred while deleting, please try again later', '#f8d7da')\n      })\n  }\n\n  handleModal = visible => this.setState({ showModal: visible })\n\n  render() {\n    return (\n      <motion.div initial={{ opacity: 0 }} animate={{ opacity: 1 }} exit={{ opacity: 0 }}>\n\n        <Popup show={this.state.showModal} handleModal={this.handleModal} color={'#f8d7da'}>\n          <DeleteMessage />\n          <Row className='justify-content-center'>\n            <Col xs='auto'>\n              <Button variant='secondary' onClick={() => this.handleModal(false)}>Close</Button>\n            </Col>\n            <Col xs='auto'>\n              <Button to={`/profile/delete-user/${this.props.loggedUser._id}`} onClick={this.deleteUser} variant='danger'>Delete account</Button>\n            </Col>\n          </Row>\n        </Popup>\n\n        <Container className=\"user-profile\">\n          <h1 className=\"mt-5 mb-3\">Welcome back {this.props.loggedUser.username} !</h1>\n\n          {/* User details */}\n          <section className=\"user-details\">\n            <article>\n              <Image src={this.props.loggedUser.imageUrl} className=\"user-img\" roundedCircle alt={this.props.loggedUser.username} />\n              <div className=\"user-fields\">\n                <p><strong>Username:</strong> {this.props.loggedUser.username}</p>\n                <p><strong>Email:</strong> {this.props.loggedUser.email}</p>\n                <p><strong>Role:</strong> {this.props.loggedUser.role}</p>\n              </div>\n            </article>\n\n            <div className=\"user-buttons\">\n              <Link to='/profile/edit-user' className=\"btn btn-info\">Edit details</Link>\n              <Button onClick={() => this.handleModal(true)} className=\"btn btn-danger\">Delete user</Button>\n\n              {this.props.loggedUser.role === 'Teacher' && this.props.teacherInfo\n                ?\n                <Link to={`/teachers/${this.props.teacherInfo._id}`} className=\"btn btn-warning\">Teacher profile</Link>\n                : this.props.loggedUser.role === 'Teacher' && !this.props.teacherInfo ?\n                  <Link to='/profile/create-teacher' className=\"btn btn-success\">Create teacher profile</Link>\n                  : null\n              }\n            </div>\n          </section>\n\n\n          {/* Your activity*/}\n          <h2 className=\"mt-5 mb-3\">Your activity</h2>\n          <Row className=\"mt-5\">\n            <Col>\n              <TabNav tabs={['Favorite Courses', 'Favorite Teachers', 'Suggested Courses']} selected={this.state.selected} setSelected={this.setSelected}   >\n                {this.state.favCourses.length > 0 &&\n                  <Tab isSelected={this.state.selected === 'Favorite Courses'} >\n                    <section>\n                      <Row>\n                        {\n                          this.state.favCourses.map(elm =>\n                            <CourseCard key={elm._id} {...elm} userInfo={this.props.loggedUser} teacher={this.props.teacherInfo} updateFavCourses={this.props.updateFavCourses} />)\n                        }\n                      </Row>\n                    </section>\n                  </Tab>\n\n                }\n                {this.state.favTeachers.length > 0 &&\n                  <Tab isSelected={this.state.selected === 'Favorite Teachers'} >\n                    <Row style={{ width: '100 %' }}>\n                      {\n                        this.state.favTeachers.map(elm =>\n                          <TeacherCard key={elm._id} {...elm} userInfo={this.props.loggedUser} teacher={this.props.teacherInfo} updateFavTeachers={this.props.updateFavTeachers} />)\n                      }\n                    </Row>\n                  </Tab>\n\n                }\n                {this.state.randomCourses.length > 0 &&\n                  <Tab isSelected={this.state.selected === 'Suggested Courses'} >\n                    <Row>\n                      {\n                        this.state.randomCourses.map(elm =>\n                          <CourseCard key={elm._id} {...elm} userInfo={this.props.loggedUser} teacher={this.props.teacherInfo} updateFavCourses={this.props.updateFavCourses} />)\n                      }\n                    </Row>\n                  </Tab>\n\n                }\n              </TabNav>\n            </Col>\n          </Row>\n\n          <Link to=\"/courses\" className=\"btn btn-outline-dark mt-5\">Go back</Link>\n        </Container>\n      </motion.div >\n    )\n  }\n}\n\n\nexport default UserProfile"]},"metadata":{},"sourceType":"module"}